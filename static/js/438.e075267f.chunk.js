"use strict";(globalThis.webpackChunkjira_assistant=globalThis.webpackChunkjira_assistant||[]).push([[438],{1438:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Ue});var n=a(7313),t=a(7890),o=a(6417);const r=(0,n.createContext)({}),i=r.Provider;let l=function(){},c=function(){};function d(e){l(e)}function m(e){const s=c();if(s)return e?s[e]:s}const u={hasExtensionSupport:!1,roomId:"",sid:"",created:0,currentIssueId:null,viewingIssueId:null,lastActivity:0,timer:0,waitingRoom:!1,moderatorId:"",members:[],issues:[],issuesMap:{},votes:[],votesMap:{},autoReveal:!1,showHalfScore:!0,maxPoints:89,showConfigs:!1},h=function(e){let{children:s,hasExtensionSupport:a}=e;const[t,r]=(0,n.useState)((()=>({...u,hasExtensionSupport:a})));return l=e=>r((s=>({...s,...e}))),c=()=>t,(0,o.jsx)(i,{value:t,children:s})},v=function(e,s,a){return a=a?Object.keys(a).reduce(((e,s)=>(e[s]=a[s](d,m),e)),{}):{},function(i){const l=(0,t.s0)(),c=(0,n.useContext)(r),d=s?s(c,i):void 0;return(0,o.jsx)(e,{...d,...i,...a,navigate:l})}};var f=a(3682),x=a(232),p=a(6123),j=a.n(p),I=a(9165),N=a(271),g=a(573),b=a(3533);const y=JSON.parse('{"apiKey":"AIzaSyDTmZ6jFnRXoWbm7xS09bBeYL7kGNxhU1M","authDomain":"optimum-rock-133908.firebaseapp.com","projectId":"optimum-rock-133908","storageBucket":"optimum-rock-133908.appspot.com","messagingSenderId":"692513716183","appId":"1:692513716183:web:ebf4a4dd0a1ca6f5bffd92","measurementId":"G-5EFPPF81EN"}'),w="poker",k="members",C="votes",S=(0,N.ZF)(y),E=(0,g.ad)(S);async function R(e){const{roomId:s,roomName:a,sid:n,token:t,scoreType:o}=e,r=(new Date).getTime(),i={roomName:a,scoreType:o,moderatorId:n,autoReveal:!1,showHalfScore:2===parseInt(o),created:r,currentIssueId:null,lastActivity:(0,g.Bt)(),timer:0,waitingRoom:!1,issues:[]};return await async function(e){const s=(0,b.v0)();await(0,b._p)(s,e)}(t),await V(i,s),await T(s,e)}async function V(e){for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];const t=(0,g.JU)(E,w,...a);return await(0,g.pl)(t,e)}async function T(e,s){const{email:a=null,sid:n,name:t,avatarUrl:o=null}=s,r={id:n,name:t,email:a,avatarUrl:o};return await V(r,e,k,n),!0}function U(e,s){return(0,g.cf)(e,(e=>{let a;"function"===typeof e.data?a={id:e.id,...e.data()}:"function"===typeof e.forEach&&(a=[],e.forEach((e=>a.push({id:e.id,...e.data()})))),s(a,e.metadata.hasPendingWrites)}))}async function M(e,s){const a=(0,g.JU)(E,w,e);await(0,g.r7)(a,s)}async function A(e,s,a){const n=(0,g.qs)(E),t=(0,g.JU)(E,w,e);n.update(t,a),n.delete((0,g.JU)(E,w,e,C,s));const o=(0,g.JU)(E,w,e,C,a.currentIssueId);n.set(o,{reveal:!1}),await n.commit()}var P=a(2284),F=a(4616);function J(e){const{sid:s,roomId:a}=e;localStorage.setItem("PRI",a),localStorage.setItem("SID",s)}async function L(e,s){let a=P.V3;s&&(a+=`/${s}`);const{success:n,message:t,...o}=await function(e,s,a){return(0,F.f3)({},"AjaxRequestService").$request.execute(e,s,a,{withCredentials:!1})}("POST",a,{email:e});if(!n)throw new Error(t);return o}function $(e){return e&&e.length?e.reduce(((e,s)=>(e[s.id]=s,e)),{}):{}}const z=()=>(Math.random()+1).toString(36).substring(7);function _(e,s){return async function(){const{roomId:e,currentIssueId:a}=s();await async function(e,s){const a=(0,g.JU)(E,w,e,C,s);return await(0,g.r7)(a,{reveal:!0})}(e,a)}}function H(e,s){return async function(e){"number"!==typeof e&&(e=null);const{roomId:a,sid:n}=s();await async function(e,s,a){const n=(0,g.JU)(E,w,e,k,s);return await(0,g.r7)(n,{avatarId:a})}(a,n,e)}}const D="\ud83d\udc4d",O="\ud83e\udd14",X=["\ud83e\uddd1\u200d\ud83d\udcbb","\ud83e\udd84","\ud83d\udc3c","\ud83e\udd81","\ud83d\udc35","\ud83d\udc28","\ud83e\udd8a","\ud83d\udc31","\ud83d\udc2f","\ud83d\udc34","\ud83d\udc19","\ud83e\udd96","\ud83d\udc0b","\ud83d\udc38","\ud83d\udc14","\ud83d\udc2e","\ud83d\udc30","\ud83d\udc27","\ud83e\udda9","\ud83d\udc22","\ud83d\udc39","\ud83d\udc3b","\ud83d\udc23","\ud83d\udc29","\ud83d\udc36","\ud83d\udc69\u200d\ud83e\uddb0","\ud83e\uddb8","\ud83e\uddde","\ud83e\uddde\u200d\u2640\ufe0f"],q={1:[0,.5,1,2,3,5,8,13,21,34,55,89],2:[0,.5,1,2,3,5,8,13,20,40,100],3:["XXS","XS","S","M","L","XL","XXL"]};class Y extends n.PureComponent{constructor(e){super(e),this.createRoom=async()=>{try{const{roomId:e}=await this.props.createRoom(this.state);this.props.navigate(`/poker/${e}`)}catch(e){console.error(e)}},this.setValue=(e,s)=>{const a={...this.state,[s]:e};a.roomError=(a.roomName||"").length<3?"Room name is too short":null,a.emailError=(a.email||"").length<3?"Email is invalid":null,a.nameError=(a.name||"").length<3?"Name is too short":null,a.hasError=!(!a.roomError&&!a.nameError),this.setState(a)},this.state={scoreType:1,hasError:!0,roomName:"Optimus",name:"Shridhar",email:"shridhar_tl@ymail.com"}}render(){const{roomName:e,name:s,email:a,scoreType:n,roomError:t,nameError:r,hasError:i}=this.state;return(0,o.jsx)("div",{className:"poker-create",children:(0,o.jsx)("div",{className:"flex justify-content-center",children:(0,o.jsxs)("div",{className:"card",children:[(0,o.jsx)("h5",{className:"text-center",children:"Create New Room"}),(0,o.jsxs)("div",{className:"p-fluid",children:[(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"roomName",field:"roomName",value:e,maxLength:15,autoFocus:!0,className:j()({"p-invalid":t}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"roomName",className:j()({"p-error":!!t}),children:"Room Name*"})]})}),(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"name",value:s,field:"name",maxLength:15,className:j()({"p-invalid":r}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"name",className:j()({"p-error":!!r}),children:"Your Name*"})]})}),(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"email",value:a,field:"email",maxLength:80,className:j()({"p-invalid":r}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"email",className:j()({"p-error":!!r}),children:"Your Email*"})]})}),(0,o.jsx)("div",{children:(0,o.jsx)(I.EU,{value:n,field:"scoreType",defaultValue:1,label:`Fibonacci (${q[1].join(", ")})`,onChange:this.setValue})}),(0,o.jsx)("div",{children:(0,o.jsx)(I.EU,{value:n,field:"scoreType",defaultValue:2,label:`Short Fibonacci (${q[2].join(", ")})`,onChange:this.setValue})}),(0,o.jsx)("div",{children:(0,o.jsx)(I.EU,{value:n,field:"scoreType",defaultValue:3,label:`T-Shirt (${q[3].join(", ")})`,onChange:this.setValue})}),(0,o.jsx)(I.zx,{label:"CREATE ROOM",className:"mt-2",disabled:i,onClick:this.createRoom})]})]})})})}}const B=v(Y,null,{createRoom:function(e){return async function(s){let{email:a,roomName:n,name:t,scoreType:o,avatarUrl:r,avatarId:i}=s;const{token:l,sid:c,roomId:d}=await L(a),m={token:l,sid:c,roomId:d,roomName:n,name:t,email:a,scoreType:o,avatarUrl:r,avatarId:i,showConfigs:!0};return J(m),await R(m),e(m),m}}});var Z=a(6848);class W extends n.PureComponent{constructor(e){var s,a;super(e),this.joinRoom=async()=>{try{const{roomId:e}=await this.props.joinRoom(this.state);this.props.navigate(`/poker/${e}`)}catch(e){console.error(e)}},this.setValue=(e,s)=>{const a={...this.state,[s]:e};a.roomError=(a.roomId||"").length<6?"Room id is too short":null,a.nameError=(a.name||"").length<3?"Name is too short":null,a.emailError=(a.email||"").length<3?"Email is too short":null,a.hasError=!!(a.roomError||a.nameError||a.emailError),this.setState(a)},this.state={scoreType:1,hasError:!0,roomId:(null===(s=e.match)||void 0===s||null===(a=s.params)||void 0===a?void 0:a.roomId)||""}}componentDidMount(){this.props.loadAuthInfoFromCache(this.state.roomId)}render(){const{roomId:e,name:s,email:a,roomError:n,nameError:t,emailError:r,hasError:i}=this.state;return(0,o.jsx)("div",{className:"poker-create",children:(0,o.jsx)("div",{className:"flex justify-content-center",children:(0,o.jsxs)("div",{className:"card",children:[(0,o.jsx)("h5",{className:"text-center",children:"Join Room"}),(0,o.jsxs)("div",{className:"p-fluid",children:[(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"roomId",field:"roomId",value:e,maxLength:15,autoFocus:!0,className:j()({"p-invalid":n}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"roomId",className:j()({"p-error":!!n}),children:"Room Id*"})]})}),(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"name",value:s,field:"name",maxLength:15,className:j()({"p-invalid":t}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"name",className:j()({"p-error":!!t}),children:"Your Name*"})]})}),(0,o.jsx)("div",{className:"field",children:(0,o.jsxs)("span",{className:"p-float-label",children:[(0,o.jsx)(I.zC,{id:"email",value:a,field:"email",maxLength:80,className:j()({"p-invalid":r}),onChange:this.setValue}),(0,o.jsx)("label",{htmlFor:"name",className:j()({"p-error":!!t}),children:"Your Email*"})]})}),(0,o.jsx)(I.zx,{label:"JOIN ROOM",className:"mt-2",disabled:i,onClick:this.joinRoom})]})]})})})}}const G=v((0,Z.E)(W),null,{joinRoom:function(e){return async function(s){let{email:a,roomId:n,name:t,avatarUrl:o,avatarId:r}=s;const{token:i,sid:l}=await L(a,n),c={token:i,sid:l,roomId:n,name:t};J(c),e(c);const d={sid:l,roomId:n,name:t,email:a,avatarUrl:o,avatarId:r};return await async function(e,s){return await T(e,s)}(n,d),d}},loadAuthInfoFromCache:function(e){return async function(s){if(!s)return;const a=await async function(e){const s={roomId:localStorage.getItem("PRI"),sid:localStorage.getItem("SID")};if(s.roomId===e)return s}(s);a?e(a):(0,b.w7)((0,b.v0)())}}});const K=function(){return(0,o.jsxs)("div",{className:"poker-start",children:[(0,o.jsx)("div",{className:"ja-header flex justify-content-center",children:(0,o.jsxs)("h1",{children:[(0,o.jsx)("img",{src:"/assets/icon_48.png",alt:""})," Jira Assistant - [Planning Poker]"]})}),(0,o.jsxs)("div",{className:"row",children:[(0,o.jsx)("div",{className:"col-lg-6",children:(0,o.jsx)(B,{})}),(0,o.jsx)("div",{className:"col-lg-6",children:(0,o.jsx)(G,{})})]}),(0,o.jsxs)("div",{className:"footer",children:[(0,o.jsxs)("span",{className:"copyright flex justify-content-center",children:["\xa9 2016-",(new Date).getFullYear()," \xa0",(0,o.jsx)("a",{href:f.ov,target:"_blank",rel:"noreferrer",children:"Jira Assistant "}),"\xa0v",x.Hm]}),(0,o.jsx)("p",{className:"flex justify-content-center",children:"The privacy policy of Jira Assistant is not completely applicable for Poker. The details you provide here like your name, jira issue key, estimates, summary, etc., would be temporarily cached in JA server to serve across all the members. However, once you end the session, all the details would automatically be cleared from cache. By proceeding with using the poker, you agree to all the terms and condiations."})]})]})};var Q=a(2328),ee=a(9523),se=a(9084);const ae=n.memo((function(e){let{className:s,value:a,placeholder:n,disabled:t,onChange:r}=e;const{$jira:{lookupIssues:i}}=(0,F.f3)("JiraService");return(0,o.jsx)(I.Qc,{value:a,displayField:"value",className:s,placeholder:n,forceSelection:!0,dataset:async function(e){const s=await i(e);return console.log(s),s},disabled:t,maxLength:20,onChange:r,autoFocus:!0,optionGroupChildren:"issues",optionGroupLabel:"label",children:e=>(0,o.jsxs)("span",{style:{fontSize:12,margin:"10px 10px 0 0"},children:[(0,o.jsx)(I.Ee,{src:e.img,alt:""}),e.key," - ",e.summaryText]})})}));var ne=a(7050);function te(e){let{showConfigs:s,currentIssueId:a,viewingIssueId:n,issues:t,isModerator:r,hideSettings:i}=e;return(0,o.jsxs)(ee.Y,{className:"config-settings",visible:s,onHide:i,modal:!1,dismissable:!1,children:[(0,o.jsx)("h3",{children:"Issues List"}),(0,o.jsxs)("div",{className:"issues-collection",children:[(0,o.jsx)("div",{className:"list-header",children:"Issues List"}),(0,o.jsx)(Q.u,{className:"help-tooltip",target:".issue-list .issue"}),(0,o.jsxs)("div",{className:"issue-list",children:[(!t||!t.length)&&(0,o.jsx)("div",{className:"empty-list",children:"No issues added"}),t.map((e=>(0,o.jsx)(le,{issue:e,selected:n===e.id,estimating:a===e.id},e.id)))]}),r&&(0,o.jsx)(ce,{})]}),r&&(0,o.jsx)(re,{})]})}const oe=[{value:8,label:"8"},{value:13,label:"13"},{value:21,label:"21"},{value:34,label:"34"},{value:55,label:"55"},{value:89,label:"89"}],re=v((function(e){let{autoReveal:s,showHalfScore:a,maxPoints:n,scoreType:t,saveSettings:r}=e;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("h3",{children:"Settings"}),(0,o.jsxs)("div",{className:"poker-settings",children:[t<3&&(0,o.jsx)("div",{children:(0,o.jsx)(I.XZ,{checked:a,field:"showHalfScore",label:"Show 0.5 story point",onChange:r})}),(0,o.jsx)("div",{children:(0,o.jsx)(I.XZ,{checked:s,field:"autoReveal",label:"Auto reveal after voting",onChange:r})}),t<3&&(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{children:"Max score"}),(0,o.jsx)(I.jL,{value:n,field:"maxPoints",dataset:oe,onChange:r})]})]})]})}),(e=>{let{autoReveal:s,scoreType:a,showHalfScore:n,maxPoints:t}=e;return{autoReveal:s,scoreType:a,showHalfScore:n,maxPoints:t}}),{saveSettings:function(e,s){return function(e,a){M(s("roomId"),{[a]:e})}}});function ie(e){e.stopPropagation()}const le=v((function(e){let{issue:{id:s,key:a,icon:t,url:r,summary:i},selected:l,estimating:c,selectIssue:d,removeIssue:m}=e;const u=(0,n.useCallback)((e=>{ie(e),ne.V.confirmDelete(`Are you sure to delete "${a}"?`,"Delete issue").then((()=>m(s)))}),[a,s,m]);return(0,o.jsxs)("div",{className:"issue"+(l?" selected":""),onClick:()=>d(s),"data-pr-tooltip":i,children:[!c&&l&&(0,o.jsx)("span",{className:"fa fa-arrow-right icon-sel-ind"}),c&&(0,o.jsx)("span",{className:"fa fa-clock-o icon-sel-ind"}),(0,o.jsx)("span",{className:"fa fa-times",onClick:u}),(0,o.jsxs)("span",{className:"issue-info",children:[(0,o.jsx)(se.Z,{src:t}),(0,o.jsxs)("span",{className:"key",children:[" ",a," "]}),(0,o.jsx)("a",{href:r,target:"_blank",rel:"noreferrer",onClick:ie,children:(0,o.jsx)("span",{className:"fa fa-external-link"})})]})]})}),null,{selectIssue:function(e){return function(s){e({viewingIssueId:s})}},removeIssue:function(e,s){return async function(a){const{issues:n,roomId:t,currentIssueId:o,viewingIssueId:r}=s(),i=n.filter((e=>e.id!==a));var l;(await async function(e,s,a){const n={issues:s};a&&(n.currentIssueId=null),await M(e,n)}(t,i,o===a),r===a)&&e({viewingIssueId:null===(l=i[0])||void 0===l?void 0:l.id})}}}),ce=v((function(e){let{addNewIssue:s}=e;const[a,t]=(0,n.useState)(!1),r=(0,n.useCallback)((()=>t(!a)),[a]);return a?(0,o.jsxs)("div",{className:"add-key",children:[(0,o.jsx)("span",{onClick:r,className:"fa fa-times"}),(0,o.jsx)(ae,{value:"",className:"issue-picker",onChange:s})]}):(0,o.jsxs)("div",{className:"add-issue",onClick:r,children:[(0,o.jsx)("span",{className:"fa fa-plus"})," Add new issue"]})}),(e=>{let{hasExtensionSupport:s}=e;return{hasExtensionSupport:s}}),{addNewIssue:function(e,s){return async function(e){"string"===typeof e&&(e={key:e});const{root:a,key:n,url:t,img:o,summaryText:r}=e,i={root:a,id:z(),key:n,url:t,icon:o,summary:r};await async function(e,s,a){const n={issues:(0,g.vr)(s)};a&&(n.currentIssueId=s.id),await M(e,n)}(s("roomId"),i,!s("currentIssueId"))}}}),de=v(n.memo(te),(e=>{let{issues:s,sid:a,moderatorId:n,currentIssueId:t,viewingIssueId:o,showConfigs:r}=e;return{issues:s,currentIssueId:t,viewingIssueId:o,showConfigs:r,isModerator:a===n}}),{hideSettings:function(e){return function(){e({showConfigs:!1})}}});var me=a(1991);const ue=function(e){let{allowVoting:s,min:a=0,max:n=89,value:t,showHalfScore:r,scoreType:i,submitVote:l}=e,c=q[i];if(!c)return null;i<3&&(c=c.filter((e=>e>=a&&e<=n&&(r||.5!==e))));const d=c.map(((e,a)=>({icon:(0,o.jsx)(he,{className:"card-color-"+(a+a%2)/2,value:e,selected:t===e,submitVote:l,allowVoting:s},e)})));return d.push({label:"Not Sure",icon:(0,o.jsx)(he,{className:"card-other icon-red",icon:"fa fa-question",value:"?",selected:"?"===t,submitVote:l,allowVoting:s})},{label:"Break",icon:(0,o.jsx)(he,{className:"card-other icon-purple",icon:"fa fa-coffee",value:"~",selected:"~"===t,submitVote:l,allowVoting:s})}),(0,o.jsx)("div",{className:"cards-list"+(s?"":" disabled"),children:(0,o.jsx)(me.s,{magnification:s,model:d,position:"bottom"})})},he=n.memo((function(e){let{className:s,value:a,icon:n,selected:t,allowVoting:r,submitVote:i}=e;return(0,o.jsxs)("div",{className:j()("card",s,{selected:t,"card-icon":!!n}),onClick:r?()=>i(a):void 0,children:[n&&(0,o.jsx)("div",{className:"card-content",children:(0,o.jsx)("div",{className:"card-val-icon",children:(0,o.jsx)("span",{className:n})})}),!n&&(0,o.jsxs)("div",{className:"card-content",children:[(0,o.jsx)("div",{className:"card-val-tl",children:a}),(0,o.jsx)("div",{className:"card-val-m",children:a}),(0,o.jsx)("div",{className:"card-val-br",children:a})]})]})})),ve=v(n.memo(ue),(e=>{var s;let{votesMap:a,sid:n,currentIssueId:t,viewingIssueId:o,maxPoints:r,scoreType:i,showHalfScore:l}=e;return{value:null===(s=a[o])||void 0===s?void 0:s[n],allowVoting:t===o,max:r,scoreType:i,showHalfScore:l}}),{submitVote:function(e,s){return async function(a){var n;const{roomId:t,sid:o,currentIssueId:r,votesMap:i}=s(),l={...i};null!==l&&void 0!==l&&null!==(n=l[r])&&void 0!==n&&n.reveal||(await async function(e,s,a,n){const t=(0,g.qs)(E),o=(0,g.JU)(E,w,e,C,a);t.update(o,{[s]:n});const r=(0,g.JU)(E,w,e,k,s);t.update(r,{[`vote_${a}`]:!0}),await t.commit()}(t,o,r,a),l[r]={...l[r],[o]:a},e({votesMap:l}))}}}),fe=v((function(e){let{isModerator:s,estimating:a,revealVote:n,startEstimation:t,restartEstimation:r,copyUrl:i,exitRoom:l}=e;const c=[s&&{label:"Reveal scores",command:n,icon:()=>(0,o.jsx)("div",{className:"control-icon icon-reveal",children:(0,o.jsx)("span",{className:"fa fa-eye"})})},s&&!a&&{label:"Start estimating",command:t,icon:()=>(0,o.jsx)("div",{className:"control-icon icon-start",children:(0,o.jsx)("span",{className:"fa fa-play"})})},s&&a&&{label:"Restart estimation",command:r,icon:()=>(0,o.jsx)("div",{className:"control-icon icon-reset",children:(0,o.jsx)("span",{className:"fa fa-refresh"})})},{label:"Copy link to invite others",command:i,icon:()=>(0,o.jsx)("div",{className:"control-icon icon-invite",children:(0,o.jsx)("span",{className:"fa fa-link"})})},{label:s?"Close this room":"Exit",command:()=>ne.V.yesNo(s?"Are you sure to close this room and clear all the data?":"Are you sure to leave this room?","Confirm exit").then(l),icon:()=>(0,o.jsx)("div",{className:"control-icon icon-exit",children:(0,o.jsx)("span",{className:"fa fa-sign-out"})})}].filter(Boolean);return(0,o.jsxs)("div",{className:"control-box",children:[(0,o.jsx)(Q.u,{className:"help-tooltip",target:".p-dock-action",my:"center+15 left-15",at:"top left"}),(0,o.jsx)(me.s,{model:c,position:"right"})]})}),(e=>{let{roomName:s,sid:a,moderatorId:n,currentIssueId:t,viewingIssueId:o}=e;return{roomName:s,issueId:o,estimating:o===t,isModerator:a===n}}),{revealVote:_,startEstimation:function(e,s){return function(){const{roomId:e,viewingIssueId:a}=s();return A(e,a,{currentIssueId:a})}},restartEstimation:function(e,s){return function(){const{roomId:e,viewingIssueId:a,issues:n}=s(),t=z(),o=n.map((e=>e.id===a?{...e,id:t}:e));return A(e,a,{currentIssueId:t,issues:o})}},copyUrl:function(e,s){return function(){var e;const a=s("roomId");null!==(e=navigator.clipboard)&&void 0!==e&&e.writeText&&navigator.clipboard.writeText(`${f.MV}/pocker/${a}`)}},exitRoom:function(){return async function(){!async function(e,s,a){}()}}});var xe=a(159);function pe(e){let{avatarUrl:s,name:a,avatarId:t,onClick:r}=e;const i=t>0||0===t,l=i?X[t]:"\ud83d\udc64",c=(0,o.jsx)(xe.q,{label:l,shape:"circle",size:"xlarge",onClick:r}),[d,m]=(0,n.useState)({});if(!s||function(e){try{return new URL(e).pathname}catch(s){console.warn("Invalid URL Passed: ",e,s)}return""}(s).length<3)return c||null;const u=e=>m({avatarUrl:s,fallback:!0});return d.fallback&&d.avatarUrl===s||i?c:(0,o.jsx)(xe.q,{image:s,shape:"circle",size:"xlarge",imageAlt:a,onImageError:u,onClick:r})}const je=v(pe,(e=>{let{sid:s,members:a}=e;return a.filter((e=>e.id===s))[0]}));const Ie=n.memo((e=>{let{members:s,votes:a,issueId:n,moderatorId:t}=e;return(0,o.jsx)("div",{className:"members-list",children:s.map((e=>(0,o.jsx)(Ne,{data:e,vote:a[e.id],issueId:n,isModerator:e.id===t},e.id)))})})),Ne=n.memo((function(e){let{data:s,vote:a,issueId:n,isModerator:t}=e;const{avatarUrl:r,avatarId:i,name:l,[`vote_${n}`]:c}=s,d=(!!a||0===a)&&"?"!==a&&"~"!==a;return(0,o.jsxs)("div",{className:"member"+(t?" moderator":""),children:[(0,o.jsx)(pe,{avatarUrl:r,avatarId:i,name:l}),(0,o.jsxs)("div",{className:"member-state",children:["?"===a&&(0,o.jsx)("span",{className:"score fa fa-question"}),"~"===a&&(0,o.jsx)("span",{className:"score fa fa-coffee"}),d&&(0,o.jsx)("span",{className:"score",children:a}),!a&&!d&&(0,o.jsx)("span",{className:"state-logo",children:c?D:O})]}),(0,o.jsx)("span",{className:"member-name",children:l})]})})),ge=v(Ie,(e=>{let{viewingIssueId:s,members:a,votesMap:n,sid:t,moderatorId:o}=e;return{members:a,issueId:s,moderatorId:o,isModerator:t===o,votes:n[s]||{}}}));var be=a(1287);const ye=v((function(e){let{roomName:s,showSettings:a}=e;return(0,o.jsxs)("div",{className:"header",children:[(0,o.jsx)("span",{className:"fa fa-cogs",onClick:a}),(0,o.jsx)(we,{}),(0,o.jsx)("div",{className:"header-txt",children:(0,o.jsxs)("h1",{children:[(0,o.jsx)("img",{src:"/assets/icon_48.png",alt:""})," Poker - [",s,"]"]})})]})}),(e=>{let{roomName:s}=e;return{roomName:s}}),{setAvatar:H,showSettings:function(e){return function(){e({showConfigs:!0})}}}),we=v(n.memo((function(e){let{setAvatar:s}=e;const a=(0,n.useRef)(null);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(je,{onClick:e=>a.current.toggle(e)}),(0,o.jsx)(be.T,{className:"avatars-overlay",ref:a,showCloseIcon:!0,dismissable:!0,children:(0,o.jsxs)("div",{className:"panel-avarars",children:[(0,o.jsx)(je,{avatarId:null,onClick:s}),X.map(((e,a)=>(0,o.jsx)(pe,{avatarId:a,onClick:()=>s(a)},a)))]})})]})})),null,{setAvatar:H});const ke=function(){return(0,o.jsxs)("div",{className:"info-box",children:[(0,o.jsx)(Ce,{}),(0,o.jsx)(Se,{})]})},Ce=v((function(e){let{vote:{average:s,finalScore:a}}=e;return(0,o.jsxs)("div",{className:"est-info",children:[(0,o.jsxs)("div",{className:"block",children:[(0,o.jsx)("span",{className:"label",children:"Final score:"}),(0,o.jsx)("span",{className:"value",children:a})]}),(0,o.jsxs)("div",{className:"block",children:[(0,o.jsx)("span",{className:"label",children:"Average:"}),(0,o.jsx)("span",{className:"value",children:s})]}),(0,o.jsxs)("div",{className:"block",children:[(0,o.jsx)("span",{className:"label",children:"Status:"}),(0,o.jsx)("span",{className:"value fa fa-clock-o"})]})]})}),(e=>{let{viewingIssueId:s,votesMap:a}=e;return{vote:a[s]||{average:"N/A",finalScore:"N/A"}}})),Se=v(n.memo((function(e){let{issue:{key:s,icon:a,url:n,summary:t}={}}=e;return(0,o.jsxs)("div",{className:"issue-details",children:[(0,o.jsx)(I.Ee,{src:a}),(0,o.jsx)("span",{className:"issue-key",children:(0,o.jsxs)("a",{href:n,target:"_blank",rel:"noreferrer",children:[" ",s]})}),!!t&&(0,o.jsxs)("span",{className:"issue-summary",children:[" - ",t]})]})})),(e=>{let{issuesMap:s,viewingIssueId:a}=e;return{issue:s[a]||{}}}));class Ee extends n.PureComponent{componentDidMount(){this.unsubscribe=this.props.watchRoom(this.props.roomId)}componentWillUnmount(){"function"===typeof this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)}render(){return(0,o.jsxs)("div",{children:[(0,o.jsx)(ye,{}),(0,o.jsx)(ke,{}),(0,o.jsx)(ge,{}),(0,o.jsx)(de,{}),(0,o.jsx)(fe,{}),(0,o.jsx)(ve,{})]})}}const Re=v(Ee,(e=>({roomId:e.roomId})),{watchRoom:function(e,s){return async function(a){const n=function(e,s){return U((0,g.JU)(E,w,e),s)}(a,(function(a){const{viewingIssueId:n,currentIssueId:t}=s(),{currentIssueId:o,issues:r}=a;n&&t&&t===o||(a.viewingIssueId=o),a.issuesMap=$(r),e(a)}));function t(e,a){const n=e.map((e=>{let{id:s}=e;return s}));return a.reduce(((e,s)=>{e[s.id]=s;const a=n.map((e=>s[`vote_${e}`])).filter((e=>"number"===typeof e));return s.average=a.avg(),s.maxVote=a.max(),e}),s("votesMap"))}const o=function(e,s){return U((0,g.hJ)(E,w,e,k),s)}(a,(function(a){const{votes:n}=s(),o=t(a,n);e({members:a,membersMap:$(a),votesMap:o});const{moderatorId:r,sid:i,autoReveal:l,currentIssueId:c}=s();l&&r===i&&a.every((e=>!!e[`vote_${c}`]))&&_(e,s)()})),r=function(e,s){const a=(0,g.hJ)(E,w,e,C);return U((0,g.IO)(a,(0,g.ar)("reveal","==",!0)),s)}(a,(function(a){const{members:n}=s(),o=t(n,a);e({votes:a,votesMap:o})}));return function(){n(),o(),r()}}}});function Ve(e){let{roomId:s,match:{params:{roomId:a}={}}={}}=e;const n=a&&s?Re:K;return(0,o.jsx)(n,{})}const Te=v((0,Z.E)(n.memo(Ve)),(e=>{let{roomId:s}=e;return{roomId:s}})),Ue=e=>{let{hasExtensionSupport:s}=e;return(0,o.jsxs)(h,{hasExtensionSupport:s,children:[(0,o.jsx)("div",{className:"poker-fallback",children:"Your screensize is too small that Poker can't support. Please use a bigger screen"}),(0,o.jsx)("div",{className:"poker-container",children:(0,o.jsxs)(t.Z5,{children:[(0,o.jsx)(t.AW,{path:":roomId",name:"Planning Poker",element:(0,o.jsx)(Te,{})}),(0,o.jsx)(t.AW,{path:"/",name:"Join",element:(0,o.jsx)(K,{})})]})})]})}}}]);