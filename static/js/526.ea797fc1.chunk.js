"use strict";(globalThis.webpackChunkjira_assistant=globalThis.webpackChunkjira_assistant||[]).push([[526],{7154:(t,e,s)=>{s.d(e,{T2:()=>a,ZP:()=>n});var i=s(6666),o=s(1404),r=s.n(o);class n{constructor(){const t=new(r().Workbook);t.created=new Date,t.creator="Jira Assistant",t.lastModifiedBy="Jira Assistant",this.document=t}addTable(t){t=i(t);const e=this.normalizeSheetName(t.attr("export-sheet-name"));console.log("Exporting ",e),this.worksheet=this.document.addWorksheet(e),this.sheetOptions={mergeCells:[],width:{},styles:[],rowsToRemove:[],rowsToHide:[]},this.curRowNum=1;const s=t.find("> thead:not([exportignore]) > tr:not([exportignore])");this.prepareData(s),console.log("header rows",s.length);const o=t.find("> tbody:not([exportignore]) > tr:not([exportignore])");this.prepareData(o),console.log("bodyRows rows",o.length),this.worksheet.views=[{state:"frozen",xSplit:0,ySplit:s.length}],this.sheetOptions.mergeCells.forEach((t=>this.worksheet.mergeCells(t)));const r=this.sheetOptions.width;Object.keys(r).forEach((t=>{const e=this.worksheet.getColumn(t),s=parseFloat(r[t])/7.178;e.width=s})),this.sheetOptions.styles.forEach((t=>{const e=this.worksheet.getCell(t.key),s=t.style,i={};"left"!==s.textAlign&&(i.horizontal=s.textAlign),"left"!==s.verticalAlign&&(i.vertical=s.verticalAlign),e.alignment=i;const o=s.fontWeight||"";e.style.font={size:this.getFontSize(s.fontSize),bold:o.indexOf("bold")>-1||o>=550}})),this.sheetOptions.rowsToHide.forEach((t=>this.worksheet.getRow(t).hidden=!0)),this.sheetOptions.rowsToRemove.orderByDescending().forEach((t=>this.worksheet.spliceRows(t,1))),this.worksheet=null,this.sheetOptions=null,this.curRowNum=null}normalizeSheetName(t){return t?t.replace(/\[/g,"(").replace(/\]/g,")").replace(/:/g,"-").replace(/[?/\\]/g,""):t}trim(t){return t.replace(/^\s+|\s+$/gm,"")}getFontSize(t){return t?t.endsWith("px")?.75*parseInt(t.replace("px",""),10):t.endsWith("pt")?parseInt(t.replace("pt",""),10):t.endsWith("em")?.0833333*parseInt(t.replace("em",""),10):void 0:t}rgbaToHex(t){if(!t)return t;const e=t.substring(t.indexOf("(")).split(","),s=parseInt(this.trim(e[0].substring(1)),10),i=parseInt(this.trim(e[1]),10),o=parseInt(this.trim(e[2]),10);e[3]=e[3]||"1)";const r=parseFloat(this.trim(e[3].substring(0,e[3].length-1))).toFixed(2);return this.fixSize(s.toString(16))+this.fixSize(i.toString(16))+this.fixSize(o.toString(16))+this.fixSize((255*r).toString(16).substring(0,2))}fixSize(t){return 1===t.length?`0${t}`:t}prepareData(t){const e=this.worksheet,s=[];t.each(((t,o)=>{o=i(o);const r=this.getColArray(o,s);if(r){e.addRow(r).commit(),this.curRowNum++}}))}getColArray(t,e){const s=t.find("> th, > td"),o=[],r=!!t.attr("exportignore");return r&&this.sheetOptions.rowsToRemove.push(this.curRowNum),t.attr("exporthidden")&&this.sheetOptions.rowsToHide.push(this.curRowNum),s.each(((t,s)=>{for(;e[o.length]>0;)e[o.length]=e[o.length]-1,o[o.length]=null;let n=(s=i(s)).attr("exportValue");if(n||(n=s.text()),n&&!r){n=n.trim();switch(s.attr("exportType")){case"int":n=function(t){if(!t)return t;const e=parseInt(t,10);return isNaN(e)?t:e}(n);break;case"float":case"number":n=function(t){if(!t)return t;const e=parseFloat(t);return isNaN(e)?t:e}(n);break;case"date":n=l(n,!0);break;case"datetime":n=l(n,!1)}}o[o.length]=n;let a=s.attr("colspan")||1;const h=(s.attr("rowspan")||1)-1;h&&(e[o.length-1]=h);const c=this.numToChar(o.length),d=this.curRowNum;if(a>1||h>0){const t=this.numToChar(o.length+(a-1)),e=this.curRowNum+h;this.sheetOptions.mergeCells.push(`${c+d}:${t}${e}`)}if(!r){if(!a||a<2){const t=s.width();t>20&&(this.sheetOptions.width[c]=t)}this.sheetOptions.styles.push({key:c+d,style:window.getComputedStyle(s.get(0),null)})}for(;a>1;)a-=1,o[o.length]=null,h&&(e[o.length-1]=h)})),o}export(t){this.document.xlsx.writeBuffer().then((e=>{!function(t,e){const s=new FileReader;s.onload=function(i){!function(t,e,s){const i=btoa(t),o=`data:${e};base64,${i}`,r=document.createElement("a");"download"in r?(r.href=o,r.setAttribute("download",s),document.body.appendChild(r),setTimeout((function(){r.click(),document.body.removeChild(r)}),66)):document.location.href=o}(s.result,t.type,e)},s.readAsBinaryString(t)}(new Blob([e],{type:"application/octet-stream"}),`${t}.xlsx`)}))}charToNum(t){for(let e=0,s=1;e<s;e++,s++)t==this.numToChar(e)&&(s=e)}numToChar(t){const e=(t-1)%26,s=this.chr(65+e),i=parseInt((t-1)/26,10);return i>0?this.numToChar(i)+s:s}chr(t){return t>65535?(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t))):String.fromCharCode(t)}}const a={XLSX:"XLSX",CSV:"CSV",PDF:"PDF"};function l(t,e){if(!t)return t;const s=new Date(t);return isNaN(s.getTime())?t:s}},4918:(t,e,s)=>{s.d(e,{Xk:()=>g.X,ZP:()=>v,jn:()=>w});var i=s(7313),o=s(8915),r=s(8041),n=s(9168),a=s(6123),l=s.n(a),h=s(747),c=s(6666),d=s(8398),p=(s(8695),s(7154)),u=s(4711);class f{export(){this.format&&"XLSX"===this.format.toUpperCase()?this.exportToXlsx():this.format&&this.format===p.T2.PDF?this.exportToPDF():this.exportToCsv()}exportToXlsx(){const t=c(this.element),e=new p.ZP(p.T2.XLSX);t.find("table.exportable").each(((t,s)=>e.addTable(s))),e.export(this.fileName)}exportToCsv(){let t=c(this.element);t.is("table")||(t=t.find("table.exportable")),this.exportTable(t,t.attr("export-sheet-name")||this.fileName||"download")}exportToPDF(){const t=c(this.element).find("table.exportable:first-child"),e=t.attr("export-sheet-name")||this.fileName||"download",s=new d.default({orientation:"landscape",unit:"in",format:"a3"});s.autoTable({html:t.get(0)}),s.save(`${e}.pdf`)}exportTable(t,e){const s=[];let i=null;function o(t,e){const s=[];t.each(((t,i)=>{c(i).children("th,td").each(((i,o)=>{o=c(o);let r=s[t];for(r||(r=s[t]=[]);null!=r[i];)i++;const n=e[i];n&&n.noExport||(e[i]={noExport:o.is("[no-export]")||o.is(":hidden")&&!o.is("[force-export]")}),r[i]=function(t){const e={encode:!0,trim:!0};let s=t.attr("export-option");s=s&&s.length>10?c.extend(e,JSON.parse(s)):e;const i=t.find("[export-data]:first");let o=(t.attr("export-data")||i.attr("export-data")||i.text()||t.text()).replace(/\r?\n|\r/g," ");return s.trim&&(o=o.trim()),o.indexOf('"')>=0&&(o=o.replace(/"/g,'""')),s.encode&&o.indexOf(",")>=0&&(o=`"${o}"`),o}(o);let a=parseInt(o.attr("colspan"));for(;a>1;)r[i+a-1]="",a--;let l=parseInt(o.attr("rowspan"));for(;l>1;){let e=s[t+l-1];e||(e=s[t+l-1]=[]),e[i]="",l--}}))}));let i="";for(let r=0;r<s.length;r++){let t="";const n=s[r];for(let s=0;s<n.length;s++){var o;null!==(o=e[s])&&void 0!==o&&o.noExport||(t+=`,${n[s]||""}`)}i+=`${t.substring(1).replace(/\r?\n|\r/g," ")}\r\n`}return i}i="string"===typeof t?o(c(`#${t} thead:not([no-export]) tr:not([no-export]):visible`),s)+o(c(`#${t} tbody:visible tr:not([no-export]):visible`),s):o(t.find("thead:not([no-export]) tr:not([no-export]):visible"),s)+o(t.find("tbody:visible tr:not([no-export]):visible"),s),(0,u.ut)(i,e)}}var g=s(551),m=s(7821),x=s(6444),b=s(6417);const w=new r.EventEmitter;class k extends i.PureComponent{constructor(t,e,s){super(t),this.eventReceived=t=>this.executeEvent(t),this.toggleFullScreen=()=>{let{isFullScreen:t}=this.state;t=!t,this.$analytics.trackEvent("Toggle full screen",x.Jk.GadgetActions,this.title,t),t?document.body.classList.add("fs-layout"):document.body.classList.remove("fs-layout"),this.columnResizeMode=t?"fit":"expand",this.setState({isFullScreen:t})},this.addWorklogOn=t=>{this.addWorklog({ticketNo:t})},this.removeGadget=()=>{this.$analytics.trackEvent("Gadget removed",x.Jk.GadgetActions,this.title),this.performAction(g.X.RemoveGadget)},this.exportData=t=>{const e=new f;e.fileName=this.title,e.format=t||this.exportFormat,e.element=this.el,this.$analytics.trackEvent("Export data",x.Jk.GadgetActions,e.format),e.export()},this.showGadgetGontextMenu=t=>(0,h.showContextMenu)(t,this.getContextMenu()),this.getHeader=()=>{const{title:t,subTitle:e,isGadget:s,props:{draggableHandle:i}}=this,o="gadget-header"+(i?" movable":"");return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{ref:i,className:o,onContextMenu:s?this.showGadgetGontextMenu:null,onDoubleClick:this.toggleFullScreen,children:[(0,b.jsx)("i",{className:`fa ${this.iconClass}`})," ",t," ",e&&(0,b.jsxs)("span",{children:[" - ",e]}),(0,b.jsxs)("div",{className:"pull-right",children:[this.renderCustomActions&&this.renderCustomActions(s),!this.hideRefresh&&this.getRefreshButton(),!this.hideMenu&&(0,b.jsx)(n.Z,{icon:"fa fa-wrench",onClick:t=>(0,h.showContextMenu)(t,this.getContextMenu())})]})]}),(0,b.jsx)("div",{className:"clearfix"})]})},this.setRef=t=>{this.el=t;const{dropProps:{dropConnector:e}={}}=this.props;e&&e(t)},(0,m.f)(this,"AnalyticsService"),this.title=e,this.iconClass=s,this.isGadget=!1!==t.isGadget,this.settings=t.settings||{fullWidth:!1,fullHeight:!1};const{fullWidth:i=!1,fullHeight:o=!1}=this.settings;this.state={fullWidth:i,fullHeight:o}}getContextMenu(){const{isFullScreen:t,fullWidth:e,fullHeight:s}=this.state,i=this.isGadget?[{separator:!0},{label:"Full width",icon:`fa fa-${e?"check-":""}circle fs-16 margin-r-5`,command:()=>this.setSizeOptions(!e,s)},{label:"Full height",icon:`fa fa-${s?"check-":""}circle fs-16 margin-r-5`,command:()=>this.setSizeOptions(e,!s)},{separator:!0},{label:"Remove",icon:"fa fa-remove",command:()=>this.removeGadget()}]:[],o=[];return this.hideExport||(o.push({separator:!0}),this.hideCSVExport||o.push({label:"Export to CSV",icon:"fa fa-file-text-o",disabled:!this.exportData,command:()=>this.exportData(p.T2.CSV)}),this.hideXLSXExport||o.push({label:"Export to Excel",icon:"fa fa-file-excel-o",disabled:!this.exportData,command:()=>this.exportData(p.T2.XLSX)}),this.hidePDFExport||o.push({label:"Export to PDF",icon:"fa fa-file-pdf-o",disabled:!this.exportData,command:()=>this.exportData(p.T2.PDF)})),[{label:"Toggle full screen",icon:"fa fa-"+(t?"compress":"expand"),command:()=>this.toggleFullScreen()},...o,...i]}componentDidMount(){this.isGadget&&(w.on("change",this.eventReceived),this.$analytics.trackEvent("Gadget loaded",x.Jk.GadgetActions,this.title))}componentWillUnmount(){w.off("change",this.eventReceived)}setSizeOptions(t,e){const{settings:s}=this;s.fullWidth=t,s.fullHeight=e,this.setState({fullWidth:t,fullHeight:e}),this.saveSettings()}UNSAFE_componentWillReceiveProps(t){if(this.settings!==t.settings){this.settings=t.settings||{};const{fullWidth:e,fullHeight:s}=this.settings;this.setState({fullWidth:e,fullHeight:s})}}performAction(t,e){const{onAction:s}=this.props;s&&s({type:t,data:e},this.props.model,this.props.index)}addWorklog(t){this.performAction(g.X.AddWorklog,t)}editWorklog(t){this.performAction(g.X.AddWorklog,{id:t})}saveSettings(){this.performAction(g.X.SettingsChanged,this.settings)}executeEvent(t){}getFullScreenButton(){if(this.isGadget)return null;const{state:{isFullScreen:t}}=this;return(0,b.jsx)(n.Z,{icon:t?"fa fa-compress":"fa fa-expand",onClick:this.toggleFullScreen,title:"Toggle full screen"})}getRefreshButton(t){const{disableRefresh:e,isLoading:s}=this.state;return(0,b.jsx)(n.Z,{icon:"fa fa-refresh",disabled:e||s,onClick:t||this.refreshData,title:"Refresh data"})}renderBase(t){const{fullWidth:e,fullHeight:s,isLoading:i,isFullScreen:r}=this.state,{isGadget:n,props:{tabLayout:a}}=this;if(a)return(0,b.jsxs)(b.Fragment,{children:[t,this.renderFooter&&this.renderFooter()]});const h=e||!n,c=s||!n,d=l()("gadget",this.className,{docked:!n,"full-width":h&&!r,"full-height":c&&!r,"half-width":!h&&!r,"half-height":!c&&!r,"full-screen":r});return(0,b.jsxs)("div",{ref:this.setRef,className:d,children:[i&&(0,b.jsx)("div",{className:"data-loader",children:(0,b.jsx)("i",{className:"fa fa-refresh fa-spin"})}),(0,b.jsxs)(o.Panel,{header:this.getHeader(),children:[t,this.renderFooter&&this.renderFooter()]})]})}render(){return(0,b.jsx)("div",{ref:this.setRef,className:"gadget half-width half-height",children:(0,b.jsx)(o.Panel,{header:"Gadget Unavailable",children:(0,b.jsx)("div",{className:"pad-22",children:"This section contains an un-known gadget. Please report about this issue to have it fixed!"})})})}}const v=k},1499:(t,e,s)=>{s.d(e,{Z:()=>c});s(7313);var i=s(4918),o=s(3997),r=s.n(o),n=s(9422),a=s(4616),l=s(6417);class h extends i.ZP{constructor(t,e,s){super(t,`Bulk import - [${e}]`,s),this.fileSelected=()=>{const t=this.fileSelector,e=t.files[0];if(e){if(!e.name.endsWith(".csv"))return this.$message.warning("Unknown file selected to import. Select a valid file to import"),void(t.value="");r().parse(e,{header:!0,transformHeader:this.transformHeader,skipEmptyLines:"greedy",complete:t=>{const{data:e}=t;e&&e.length||this.$message.warning("No rows found to import","No records exists"),this.processData(e)}})}t.value=""},this.getTicketLink=t=>(0,l.jsx)("a",{className:"link",href:this.$userutils.getTicketUrl(t),target:"_blank",rel:"noopener noreferrer",children:t}),this.setFileSelector=t=>this.fileSelector=t,this.chooseFileForImport=()=>this.fileSelector.click(),(0,a.f3)(this,"UserUtilsService"),this.isGadget=!1,this.hideRefresh=!0}formatDate(t){return t instanceof Date?this.$userutils.formatDateTime(t):t}renderCustomActions(){return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("input",{ref:this.setFileSelector,type:"file",className:"hide",accept:".csv,.json, .xlsx",onChange:this.fileSelected}),(0,l.jsx)(n.zx,{icon:"fa fa-upload",onClick:this.chooseFileForImport,title:"Choose file to import"})]})}}const c=h},5233:(t,e,s)=>{s.d(e,{Z:()=>a});var i=s(7313),o=s(9422),r=s(6417);class n extends i.PureComponent{render(){const{isLoading:t,selectedCount:e,clearImportData:s,importIssues:i}=this.props,n=`Import ${e||""} Issues`;return(0,r.jsx)("div",{className:"pnl-footer",children:(0,r.jsxs)("div",{className:"pull-right",children:[(0,r.jsx)(o.zx,{type:"info",icon:"fa fa-list",label:"Clear",disabled:t,onClick:s}),(0,r.jsx)(o.zx,{type:"success",icon:"fa fa-upload",disabled:t||!(e>0),label:n,onClick:i})]})})}}const a=n},8971:(t,e,s)=>{s.d(e,{x:()=>p});const i="issuekey",o="parent",r="project",n="issuetype",a="assignee",l="reporter",h="timetracking.originalEstimate",c="timetracking.remainingEstimate",d={issuekey:i,ticketno:i,ticket:i,issue:i,key:i,id:i,project:r,projectkey:r,projectid:r,parent:o,parentkey:o,parentticket:o,parentticketno:o,parentissue:o,parentid:o,status:"status",issuestatus:"status",summary:"summary",priority:"priority",resolution:"resolution",description:"description",estimate:h,originalestimate:h,initialestimate:h,remaining:c,remainingestimate:c,currentestimate:c,assignee:a,assignto:a,assignedto:a,reporter:l,reported:l,reportedby:l,issuetype:n,type:n,label:"labels"};function p(t){return e=>{e=e.replace(/ /g,"").toLowerCase();let s=d[e]||null;if(!s){const i=t.first((t=>t.id.toLowerCase()===e||t.name.replace(/ /g,"").toLowerCase()===e||t.clauseNames&&t.clauseNames.some((t=>t.replace(/ /g,"").toLowerCase()===e))));i&&(s=i.id)}return s||e}}},9464:()=>{}}]);